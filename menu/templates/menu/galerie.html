{% extends 'menu/base.html' %}
{% load static %}

{% block title %}Galerie - Midway Café{% endblock %}

{% block content %}
<style>
/* ---- Particules flottantes pour la galerie ---- */
.particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

.particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: #e6c48c;
    border-radius: 50%;
    animation: float 6s infinite linear;
    opacity: 0.6;
}

@keyframes float {
    0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 0.6;
    }
    90% {
        opacity: 0.6;
    }
    100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
    }
}

.gallery-container {
    background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
    min-height: 100vh;
    padding: 2rem 0;
    position: relative;
}

.gallery-title {
    font-size: 3.5rem;
    font-weight: 800;
    color: #2c3e50;
    text-align: center;
    margin-bottom: 3rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    position: relative;
}

.gallery-title::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 4px;
    background: linear-gradient(90deg, #e6c48c, #d4af37);
    border-radius: 2px;
}

.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 1rem;
}

.gallery-item {
    position: relative;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    cursor: pointer;
    background: white;
}

.gallery-item:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

.gallery-item img {
    width: 100%;
    height: 250px;
    object-fit: cover;
    transition: all 0.4s ease;
}

/* Image spéciale accueil - plus grande et centrée */
.gallery-item.featured {
    grid-column: 1 / -1;
    max-width: 800px;
    margin: 0 auto;
    position: relative;
}

.gallery-item.featured img {
    height: 400px;
    border-radius: 25px;
    border: 3px solid #e6c48c;
    box-shadow: 0 15px 50px rgba(230, 196, 140, 0.3);
}

.gallery-item.featured:hover {
    transform: translateY(-15px) scale(1.03);
    box-shadow: 0 25px 60px rgba(230, 196, 140, 0.4);
}

.gallery-item.featured:hover img {
    transform: scale(1.05);
    box-shadow: 0 20px 60px rgba(230, 196, 140, 0.5);
}

.gallery-item.featured .gallery-overlay {
    background: linear-gradient(45deg, rgba(230, 196, 140, 0.95), rgba(212, 175, 55, 0.95));
    border-radius: 25px;
}

.gallery-item.featured .gallery-overlay h3 {
    font-size: 2rem;
    font-weight: 800;
    text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
}

.gallery-item.featured .gallery-overlay p {
    font-size: 1.2rem;
    font-weight: 600;
}

.gallery-item:hover img {
    transform: scale(1.1);
}

.gallery-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(230, 196, 140, 0.9), rgba(212, 175, 55, 0.9));
    opacity: 0;
    transition: all 0.4s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

.gallery-item:hover .gallery-overlay {
    opacity: 1;
}

.gallery-overlay h3 {
    color: white;
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    transform: translateY(20px);
    transition: all 0.3s ease;
}

.gallery-item:hover .gallery-overlay h3 {
    transform: translateY(0);
}

.gallery-overlay p {
    color: white;
    font-size: 1rem;
    opacity: 0.9;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    transform: translateY(20px);
    transition: all 0.3s ease 0.1s;
}

.gallery-item:hover .gallery-overlay p {
    transform: translateY(0);
}

.zoom-icon {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255,255,255,0.9);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.gallery-item:hover .zoom-icon {
    opacity: 1;
    transform: scale(1.1);
}

.zoom-icon i {
    color: #2c3e50;
    font-size: 1.2rem;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.9);
    animation: fadeIn 0.3s ease;
}

.modal-content {
    position: relative;
    margin: auto;
    padding: 0;
    width: 80%;
    max-width: 800px;
    top: 50%;
    transform: translateY(-50%);
    animation: zoomIn 0.3s ease;
}

.modal img {
    width: 100%;
    height: auto;
    border-radius: 10px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

.close {
    position: absolute;
    top: -40px;
    right: 0;
    color: white;
    font-size: 2rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.close:hover {
    color: #e6c48c;
    transform: scale(1.1);
}

/* Boutons de navigation */
.nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    color: white;
    font-size: 2rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(0,0,0,0.5);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
}

.nav-btn:hover {
    color: #e6c48c;
    background: rgba(0,0,0,0.8);
    transform: translateY(-50%) scale(1.1);
}

.nav-btn.prev {
    left: 20px;
}

.nav-btn.next {
    right: 20px;
}

.nav-btn.disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.nav-btn.disabled:hover {
    transform: translateY(-50%) scale(1);
    background: rgba(0,0,0,0.5);
    color: white;
}

.modal-caption {
    position: absolute;
    bottom: -50px;
    left: 0;
    right: 0;
    text-align: center;
    color: white;
    font-size: 1.2rem;
    font-weight: 600;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes zoomIn {
    from { transform: translateY(-50%) scale(0.8); opacity: 0; }
    to { transform: translateY(-50%) scale(1); opacity: 1; }
}

@media (max-width: 768px) {
    .gallery-title {
        font-size: 2.5rem;
    }
    
    .gallery-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }
    
    .gallery-item img {
        height: 200px;
    }
}
</style>

<div class="gallery-container">
    <!-- Particules flottantes -->
    <div class="particles" id="particles"></div>
    
    <h1 class="gallery-title">
        <i class="bi bi-images text-warning"></i> Galerie Photos
    </h1>
    
    <div class="gallery-grid">
        <!-- Image spéciale accueil -->
        <div class="gallery-item featured" onclick="openModal('{% static 'menu/accueil.jpg' %}', 'Accueil Midway Café')">
            <img src="{% static 'menu/accueil.jpg' %}" alt="Accueil Midway Café" loading="lazy">
            <div class="gallery-overlay">
                <h3>Accueil Midway Café</h3>
                <p>Bienvenue dans notre univers café</p>
            </div>
            <div class="zoom-icon">
                <i class="bi bi-zoom-in"></i>
            </div>
        </div>
        
        {% for image in images %}
        <div class="gallery-item" onclick="openModal('{{ image.url }}', '{{ image.alt }}')">
            <img src="{{ image.url }}" alt="{{ image.alt }}" loading="lazy">
            <div class="gallery-overlay">
                <h3>{{ image.alt }}</h3>
                <p>Cliquez pour agrandir</p>
            </div>
            <div class="zoom-icon">
                <i class="bi bi-zoom-in"></i>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Modal -->
<div id="imageModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="nav-btn prev" onclick="previousImage()" id="prevBtn">‹</div>
        <div class="nav-btn next" onclick="nextImage()" id="nextBtn">›</div>
        <img id="modalImage" src="" alt="">
        <div class="modal-caption" id="modalCaption"></div>
    </div>
</div>

<script>
// Variables globales pour la navigation
let currentImageIndex = 0;
let galleryImages = [];

// Initialiser la liste des images
function initializeGallery() {
    const galleryItems = document.querySelectorAll('.gallery-item');
    galleryImages = Array.from(galleryItems).map(item => {
        const img = item.querySelector('img');
        const alt = item.querySelector('.gallery-overlay h3').textContent;
        return {
            src: img.src,
            alt: alt
        };
    });
}

function openModal(imageSrc, imageAlt) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    const modalCaption = document.getElementById('modalCaption');
    
    // Trouver l'index de l'image actuelle
    currentImageIndex = galleryImages.findIndex(img => img.src === imageSrc);
    
    modal.style.display = 'block';
    modalImg.src = imageSrc;
    modalCaption.textContent = imageAlt;
    
    // Mettre à jour les boutons de navigation
    updateNavigationButtons();
    
    // Empêcher le scroll du body
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    const modal = document.getElementById('imageModal');
    modal.style.display = 'none';
    
    // Restaurer le scroll du body
    document.body.style.overflow = 'auto';
}

function nextImage() {
    if (currentImageIndex < galleryImages.length - 1) {
        currentImageIndex++;
        updateModalImage();
    }
}

function previousImage() {
    if (currentImageIndex > 0) {
        currentImageIndex--;
        updateModalImage();
    }
}

function updateModalImage() {
    const modalImg = document.getElementById('modalImage');
    const modalCaption = document.getElementById('modalCaption');
    
    modalImg.src = galleryImages[currentImageIndex].src;
    modalCaption.textContent = galleryImages[currentImageIndex].alt;
    
    updateNavigationButtons();
}

function updateNavigationButtons() {
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    
    // Bouton précédent
    if (currentImageIndex === 0) {
        prevBtn.classList.add('disabled');
    } else {
        prevBtn.classList.remove('disabled');
    }
    
    // Bouton suivant
    if (currentImageIndex === galleryImages.length - 1) {
        nextBtn.classList.add('disabled');
    } else {
        nextBtn.classList.remove('disabled');
    }
}

// Fermer la modal en cliquant en dehors de l'image
window.onclick = function(event) {
    const modal = document.getElementById('imageModal');
    if (event.target === modal) {
        closeModal();
    }
}

// Navigation au clavier
document.addEventListener('keydown', function(event) {
    const modal = document.getElementById('imageModal');
    if (modal.style.display === 'block') {
        switch(event.key) {
            case 'Escape':
                closeModal();
                break;
            case 'ArrowLeft':
                previousImage();
                break;
            case 'ArrowRight':
                nextImage();
                break;
        }
    }
});

// Animation d'apparition des éléments
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, observerOptions);

// Créer des particules flottantes
function createParticles() {
    const particlesContainer = document.getElementById('particles');
    const particleCount = 40;
    
    for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 6 + 's';
        particle.style.animationDuration = (Math.random() * 3 + 4) + 's';
        particlesContainer.appendChild(particle);
    }
}

// Observer tous les éléments de galerie
document.addEventListener('DOMContentLoaded', function() {
    // Créer les particules
    createParticles();
    
    // Initialiser la galerie
    initializeGallery();
    
    const galleryItems = document.querySelectorAll('.gallery-item');
    galleryItems.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateY(30px)';
        item.style.transition = `all 0.6s ease ${index * 0.1}s`;
        observer.observe(item);
    });
    
    // Effet de parallaxe sur les particules
    window.addEventListener('mousemove', function(e) {
        const particles = document.querySelectorAll('.particle');
        const x = e.clientX / window.innerWidth;
        const y = e.clientY / window.innerHeight;
        
        particles.forEach((particle, index) => {
            const speed = (index % 3 + 1) * 0.5;
            particle.style.transform = `translate(${x * speed * 10}px, ${y * speed * 10}px)`;
        });
    });
});
</script>
{% endblock %} 